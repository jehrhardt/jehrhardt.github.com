<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: RESTful APIs | derjan]]></title>
  <link href="http://derjan.io/blog/categories/restful-apis/atom.xml" rel="self"/>
  <link href="http://derjan.io/"/>
  <updated>2012-11-26T20:26:29+01:00</updated>
  <id>http://derjan.io/</id>
  <author>
    <name><![CDATA[Jan Ehrhardt]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Making stateless applications deal with RESTful state]]></title>
    <link href="http://derjan.io/blog/2012/11/26/making-stateless-applications-deal-with-restful-state/"/>
    <updated>2012-11-26T09:17:00+01:00</updated>
    <id>http://derjan.io/blog/2012/11/26/making-stateless-applications-deal-with-restful-state</id>
    <content type="html"><![CDATA[<p>One of the core priciples of RESTful APIs is being stateless on the
server. Instead of putting it on the server state is transfered to the
client. We do not talk about state as it might appear in many stateful
applications. The state in RESTful APIs is represented through
hyperlinks.</p>

<p>Hyperlinks allow applications to make navigation similar to
browsers. When you are developing a mobile application, your buttons
should behave like links in a browser. Your application should not
build the URLs to call. When the button is clicked it should call an
URL from a link. The state where the user is and how to get where he
wants is stored in the client by associating URLs from the server with
buttons.</p>

<p>When you are developing a web application, that renders HTML on the
server and you want to integrate some third party RESTful API, you
might have a problem. You can not store the links anywhere as long as
you want to keep your web application stateless. This constraint would
force you to start at the root URL and navigate down through a link
structure every request.</p>

<p>The solution is a simple key value cache. You can use it to store
state access. This does not mean you are caching where the user
currently is in your application, instead you are caching the links. A
simple example:</p>

<p>```json
{
  "links": [</p>

<pre><code>{
  "href": "http://api.foo.com/inbox/",
  "rel": "inbox"
}
</code></pre>

<p>  ]
}
```</p>

<p>In the above JSON snippet the link object has a <em>rel</em> attribute. To
cache that link create a key from the rel attribute's value inbox and
store the URL. Now you can render some HTML with a different link:</p>

<p><code>html
&lt;a href="http://derjan.io/foo/inbox/"&gt;My Foo Inbox&lt;/a&gt;
</code></p>

<p>Once the user clicks the link, you can simply grep the URL from the
cache and call it. No need for starting at <em>http://api.foo.com</em> and
following the links down to one with rel inbox.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Links, URLs and URNs to identify entities in RESTful APIs]]></title>
    <link href="http://derjan.io/blog/2012/09/17/links-urls-and-urns-to-identify-entities-in-restful-apis/"/>
    <updated>2012-09-17T23:30:00+02:00</updated>
    <id>http://derjan.io/blog/2012/09/17/links-urls-and-urns-to-identify-entities-in-restful-apis</id>
    <content type="html"><![CDATA[<p>Modern APIs are <a href="https://en.wikipedia.org/wiki/REST">RESTful</a>. It is a
good idea, since REST is based on the main principles of the
<a href="https://en.wikipedia.org/wiki/WWW">WWW</a> like
<a href="https://en.wikipedia.org/wiki/HTTP">HTTP</a> and
<a href="https://en.wikipedia.org/wiki/URL">URLs</a>. URLs allow browsers to
identify resources.</p>

<p>But how are you dealing with URLs in your API? Are you telling your
users how to create URLs?  And what is about navigation?  Do your
users know how to navigate through the data your API offers? Knowing
some basic priciples might improve your APIs a lot.</p>

<!--more-->


<h2>Starting small</h2>

<p>Most applications start small. So let us look at a simple example a
photo album application. Everytime a user opens the URL of a photo
album in his browser, a HTML page is loaded. In this case, the page
might contain thumbnails of all the photos from the album. The
thumbnails might be hyperlinks pointing to the URL of the image
details. If the user clicks on the thumbnail a new HTML page opens
with a bigger view of the picture and probably more information about
it.</p>

<p>This simple case contains a really powerful concept - hyperlinking. If
we want to provide a mobile app to our users or an API for third party
developers, we should adapt this awesome concept to our API.</p>

<p>In JSON based formats hyperlinks can be put into an attribute called
links, which is an array of link objects. This might look like below.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span><span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class='line'>  <span class="p">{</span><span class="nt">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Cool picture&quot;</span><span class="p">,</span>
</span><span class='line'>   <span class="nt">&quot;rel&quot;</span><span class="p">:</span> <span class="s2">&quot;details&quot;</span><span class="p">,</span>
</span><span class='line'>   <span class="nt">&quot;href&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.org/albums/12/photos/13&quot;</span><span class="p">}</span>
</span><span class='line'><span class="p">]}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>A mobile app can also show the thumbnails and store locally the URL
from the link object. When the user tabs with his finger on the image,
the app can do the same as the browser does. It can simply follow URL
from the link to show the image details.</p>

<h2>The power of links, when you grow</h2>

<p>Hopefully our service is growing and a simple monolithic web
application with a MySQL database does not work anymore. So we are
starting to store our image files and metadata in a different
application highly optimized to store masses of photos. This is where
hyperlinking shows it's real power.</p>

<p>Our new photo storage application might provide URLs with a completely
different structur. The URLs even might point to a different subdomain
as our web application. While the image tags in our HTML contain other
URLs, the browser does not care about any change at this point.</p>

<p>Different to the browser, the JSON for our mobile app might now be
served partially by the photo storage application. This is possible,
since the app does not know anything about the URL. It just gets it
from a link object in the JSON document.</p>

<h2>Where hyperlinking does not fit anymore</h2>

<p>Although hyperlinking allows clients to behave similar to browsers and
thus become more independent of URL structurs, this concept is
limited. It works well, when the client has a temporary local state,
where the links are stored.</p>

<p>When a user now opens the URL of a photo album in the browser, how
does the photo album application on the server know, which thumbnail
URLs it should put to the image tags? The applications could store
some redundant data, that allows some mapping. Or the album
application might store the URLs to the photos in the storage
application. Both are no good solution to the problem.</p>

<p>The problem lies in the URLs, since the L is for location, an URL does
not identify an entity of our application, it identifies a location,
where the entity can be found. Well it is an easy task to create
different URLs all pointing to the same entity. But how can entities
be identified in RESTful APIs? Even across different applications or
companies?</p>

<p>There are two classes of
<a href="https://en.wikipedia.org/wiki/URI">URIs</a>. URLs are one of them and
<a href="https://en.wikipedia.org/wiki/Uniform_Resource_Name">URNs</a> are the
other. The N in URN is for name and thus a URN is a name or better an
identifier for an entity. In a JSON format simply place the URN into
an id attribute for the object. The client can now store a global
identifier, that works location independent.</p>

<p>Using a URN like <em>urn:my-company:photo:13</em> allows us to store an id
for each photo from the storage application in the album's
database. At same time we can define a simple mapping between URNs and
URLs using <a href="http://tools.ietf.org/html/rfc6570">URI templates</a>.</p>

<p>Using ids is not as smart as hyperlinks, but with URNs they can be
handled also pretty well.</p>
]]></content>
  </entry>
  
</feed>
